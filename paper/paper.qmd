---
title: "Inflation of Egg Prices Across Canadian Grocery Stores"
author: Tara Chakkithara
date: "`r Sys.Date()`"
abstract: "After the COVID-19 pandemic, inflation has been a large economic issue for the majority of Canadians. This analysis studies the inflation of egg prices in 2024 and finds that prices have decreased compared to mid 2024. By understanding how the prices of staple grocery items fluctuate, we can gauge the effect of inflation on the general Canadian consumer."
thanks: "Code available at : https://github.com/redpinecube/grocery "
format: pdf
warning: false
echo: false
bibliography: references.bib
---

# Introduction

```{r}
library(tidyverse)
library(RColorBrewer)
data <- read_csv("../data/clean/clean_data.csv")
```

Groceries in Canada have been one of the consumer goods most affected by inflation. According to the Bank of Canada, the main reason for this is because grocery prices are affected by factors such as "cost of energy, labor, and transportation", [@citeBankOfCanada]. Past inflation trends in the United States show that grocieries most affected by inflation are eggs, dairy products, and lettuce. In 2022, egg prices increased by 60% in the United States [@citeCNBC]. This analysis studies Canadian egg prices as they are a common good most people buy and they are heavily impacted by inflation. Another reason why groceries are very expensive is because there is limited competition in the grocery market. Loblaws essentially dominates Canada's market and practices price gouging [@citeAppel].

\newpage

# Data

The data used for this analysis was sourced from Jacob Filipp's Project Hammer. This project "aims to drive more competition and reduce collusion in the Canadian grocery sector" [@citeData]. The raw data consists of two data sets: one containing detailed product information from the grocery vendors Voila, T&T, Loblaws, No Frills, Metro, Galleria, Walmart, and Save-On-Foods, and the other containing time series data on product prices. This data was filtered and cleaned using R [@citeR] and the Tidyverse package [@citeTidyverse], to examine discrepancies in egg prices over time. A clean data set was constructed with the following variables for analysis: price of an egg, vendor, time, egg color, egg size, product brand, egg type, and whether the product was on sale or not. This section briefly examines variables of interest.

### Egg Prices

The average price of an egg in Canada in 2024 was \$0.52. The minimum price of an egg was \$0.3 while the maximum price was \$0.82. The distribution of egg prices can be seen in [@fig-egg-density], with two modes at 0.42 and 0.6. The trend of egg prices over time in 2024 can be seen in [@fig-egg-price]. In 2024, egg prices increased dramatically from February to October but then faced a sharp price decline afterward. According to Sylvain Charlebois, a "professor in food distribution policy at Dalhousie University," grocery prices dropped in fall since the Bank of Canada "cut interest rates by 25 basis points" [@citeNationalPost].

```{r}
#| label: fig-egg-density
#| fig-cap: "Density of Canadian Egg Prices in 2024"
#| fig.width: 5
#| fig.height: 3

data |> 
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 10, price_per_unit)
  ) |>
  ggplot(aes(x = price_per_unit)) +
  geom_density(fill = "skyblue", color = "skyblue", alpha = 0.6) + 
  labs(
    x = "Price Per Egg",                       
    y = "Density",                             
  ) +
  theme_bw() +                            
  theme(
    plot.title = element_text(size = 16, face = "bold", hjust = 0.5),  
    axis.title = element_text(size = 12),       
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )
```

```{r}
#| label: fig-egg-price
#| fig-cap: "Canadian Egg Prices by Month in 2024"
#| fig.width: 5
#| fig.height: 3

data |> 
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 10, price_per_unit),
    month = month(time) 
  ) |> 
  group_by(month) |> 
  summarise(avg_price = mean(price_per_unit, na.rm = TRUE)) |> 
  ggplot(aes(x = month, y = avg_price)) +
  geom_line(color = "skyblue") +
  labs(x = "Month", y = "Average Price per Egg") +
  scale_x_continuous(
    breaks = 1:12,
  ) +
  theme_bw() +
  theme(
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )
```

### Grocery Vendors & Brands

Three popular grocery vendors were considered in this analysis: Loblaws, Metro, and Voila. As seen in [@fig-vendor-brands], the brands these vendors source their eggs from include Blue Menu, Compliments, Conestoga Eggs, Gold Egg, Gray Ridge, Longo's, and President's Choice. Among the vendors, Metro offers the most expensive eggs, followed by Loblaws, with Voila being the least expensive, as seen in [@fig-vendor-price]. Price per egg at Metro is \$0.64 on average, \$0.62 for Loblaws, and \$0.51 for Voila. From February to April, the price of eggs decreased for Metro and Voila while it increased for Loblaws. During this price hike, Loblaws was accused of price gouging by many consumers, prompting a boycott of the retailer [@citeAppel].

According to [@fig-brand-price], Blue Menu and Conestoga Eggs are the priciest brands, while Compliments and Gray Ridge are the more affordable options. Compliments is a store brand launched by the retailer Sobeys in 2005 [@citeSobeys]. Store brands, like Compliments, are often a more economical choice for consumers compared to name brands. For example, in the United States, "consumers save more than \$40 billion a year on grocery and household purchases by opting for the store brand over the national brand version of their favorite products" [@citePLMA].

```{r}
#| label: fig-vendor-brands
#| fig-cap: "Frequency Distribution of Price Changes by Brand"
#| fig.width: 5
#| fig.height: 3

data |>
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 10, price_per_unit)
  ) |>
  ggplot(aes(x = vendor, fill = brand)) + 
  geom_bar(position = "dodge") +        
  labs(
    x = "Vendor", 
    y = "Count",
    fill = "Brand"
  ) +
  scale_fill_brewer(palette = "Set3") +  
  theme_bw() +
  theme(
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )
```

```{r}
#| label: fig-vendor-price
#| fig-cap: "Average 2024 Egg Prices by Canadian Vendors over Time"
#| fig.width: 5
#| fig.height: 3
data |> 
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 12, price_per_unit),
    month = month(time) 
  ) |> 
  group_by(month, vendor) |>  
  summarise(avg_price = mean(price_per_unit, na.rm = TRUE), .groups = "drop") |> 
  ggplot(aes(x = month, y = avg_price, color = vendor, group = vendor)) + 
  geom_line() +   
  labs(
    x = "Month",               
    y = "Average Price per Egg", 
    color = "Vendor"
  ) + 
  scale_x_continuous(
    breaks = 1:12,  
    labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
  ) + 
  scale_color_brewer(palette = "Set1") +
  theme_bw() + 
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )
```

```{r}
#| label: fig-brand-price
#| fig-cap: "Average 2024 Egg Prices by Canadian Brands over Time"
#| fig.width: 5
#| fig.height: 3
data |> 
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 12, price_per_unit),
    month = month(time) 
  ) |> 
  group_by(month, brand) |>  
  summarise(avg_price = mean(price_per_unit, na.rm = TRUE), .groups = "drop") |> 
  ggplot(aes(x = month, y = avg_price, color = brand, group = brand)) + 
  geom_line() +   
  labs(
    x = "Month",               
    y = "Average Price per Egg", 
    color = "Brand"
  ) + 
  scale_x_continuous(
    breaks = 1:12,  
    labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
  ) + 
  scale_color_brewer(palette = "Set2") +
  theme_bw() + 
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )
```

### Egg Color, Size, and Type

Chicken eggs sold at Metro, Loblaws, and Voila, come in two colors and three sizes. Eggs are either white or brown and they are labeled medium, large, or extra large. As seen in [@fig-egg-size], medium sized eggs are the most expensive, followed by extra large eggs, with large eggs being the cheapest. [@fig-egg-color] shows that egg color is a strong indicator of price. Brown eggs on average cost around \$0.57, while white eggs cost on average \$0.44. Brown eggs com from larger breeds of chickens that require "more food, which makes the eggs more expensive for farmers to produce" [@citeConsumerReports].

Eggs are also divided by the conditions their hens are raised in. Some common ways hens can be raised is organic, free range, free run, and none of the above. Looking at [@fig-egg-type] tells us that organic eggs have an average sell price greater than \$0.70 per egg which is around \$0.20 higher than the average price of an egg. Eggs that are not raised in farms with special conditions are the cheapest with an average price point of \$0.40. Free range and free run eggs have similar price points around \$0.60 with free range being \$0.02 higher in price per egg.

```{r}
#| label: fig-egg-size
#| fig-cap: "Average 2024 Egg Prices by Egg Size over Time"
#| fig.width: 5
#| fig.height: 3
data |> 
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 12, price_per_unit),
    month = month(time) 
  ) |> 
  group_by(month, size) |>  
  summarise(avg_price = mean(price_per_unit, na.rm = TRUE), .groups = "drop") |> 
  ggplot(aes(x = month, y = avg_price, color = size, group = size)) + 
  geom_line() +   
  labs(
    x = "Month",               
    y = "Average Price per Egg", 
    color = "Size"
  ) + 
  scale_x_continuous(
    breaks = 1:12,  
    labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
  ) + 
  scale_color_brewer(palette = "Set1") +
  theme_bw() + 
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )
```

```{r}
#| label: fig-egg-color
#| fig-cap: "Average 2024 Egg Prices by Egg Color over Time"
#| fig.width: 5
#| fig.height: 3
data |> 
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 12, price_per_unit),
    month = month(time) 
  ) |> 
  group_by(month, color) |>  
  summarise(avg_price = mean(price_per_unit, na.rm = TRUE), .groups = "drop") |> 
  ggplot(aes(x = month, y = avg_price, color = color, group = color)) + 
  geom_line() +   
  labs(
    x = "Month",               
    y = "Average Price per Egg", 
    color = "Color"
  ) + 
  scale_x_continuous(
    breaks = 1:12,  
    labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
  ) + 
  scale_color_brewer(palette = "Set2") +
  theme_bw() + 
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )

```

```{r}
#| label: fig-egg-type
#| fig-cap: "Average 2024 Egg Prices by Farming Conditions"
#| fig.width: 5
#| fig.height: 3
data |> 
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 12, price_per_unit),
    month = month(time) 
  ) |> 
  group_by(month, type) |>  
  summarise(avg_price = mean(price_per_unit, na.rm = TRUE), .groups = "drop") |> 
  ggplot(aes(x = month, y = avg_price, color = type, group = type)) + 
  geom_line() +   
  labs(
    x = "Month",               
    y = "Average Price per Egg", 
    color = "Farming Conditions"
  ) + 
  scale_x_continuous(
    breaks = 1:12,  
    labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
  ) + 
  scale_color_brewer(palette = "Set2") +
  theme_bw() + 
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )

```

### Sale

In 2024, the price of discounted eggs was up to \$0.23 cheaper than the average cost of non sale eggs which was around \$0.53. The largest discount price occurred in July, followed by minor peaks in discounts in October and December, as seen in [@fig-egg-discount].

```{r}
#| label: fig-egg-discount
#| fig-cap: "Average 2024 Egg Prices by Discount Type over Time"
#| fig.width: 5
#| fig.height: 3
data |> 
  mutate(
    price_per_unit = if_else(price_per_unit > 3, price_per_unit / 12, price_per_unit),
    month = month(time) 
  ) |> 
  group_by(month, sale) |>  
  summarise(avg_price = mean(price_per_unit, na.rm = TRUE), .groups = "drop") |> 
  ggplot(aes(x = month, y = avg_price, color = sale, group = sale)) + 
  geom_line() +   
  labs(
    x = "Month",               
    y = "Average Price per Egg", 
    color = "Sale"
  ) + 
  scale_x_continuous(
    breaks = 1:12,  
    labels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec")
  ) + 
  scale_color_brewer(palette = "Set2") +
  theme_bw() + 
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    axis.text = element_text(size = 10),       
    panel.grid.major = element_line(color = "gray90"),  
    panel.grid.minor = element_blank(),                
    plot.caption = element_text(size = 8, face = "italic", hjust = 1),
    axis.title.x = element_text(margin = margin(t = 10)),
    axis.title.y = element_text(margin = margin(r = 10))
  )

```

## Measurement

Variables such as egg size are challenging to measure accurately, as many brands rely on subjective labels like "large," "medium," or "extra large." On the other hand, some variables in this analysis, such as egg price, are easier to measure and more reliable, as prices are typically set by the retailer. However, itâ€™s important to note that gathering a comprehensive measurement of prices across all vendors and brands is difficult, particularly due to the large number of small businesses across Canada that this dataset may not fully capture.

Similarly, assessing farming conditions is inherently subjective. Farmers within each category often follow different standards, making it difficult to measure farming conditions consistently.

# Model

A multivariate linear regression model was built to predict egg prices. The predictors chosen for the model were: sale, organic, brown, voila and month. All variables except for month are indicator variables. Month is an integer that represents the months past the first day of 2024. This model can be represented using the following equation :

$$
\text{price} = \beta_0 + \beta_1 \cdot \text{sale} + \beta_2 \cdot \text{voila} + \beta_3 \cdot \text{brown} + \beta_4 \cdot \text{large} + \beta_5 \cdot \text{organic}
\tag{1}
$$

Where :

$\beta_0$ is the intercept.

$\beta_1, \beta_2, \cdots, \beta_5$ are the coefficients for the independent variables defined.

$\epsilon$ is the error term that accounts for uncertainty.

This model assumes that the predictor variables are independent of each other. It also assumes linear relationships between the predictors and egg pricing. The potential limitation of this model is that it's susceptible to outliers. Extreme values could significantly alter results. The variables included in the model were selected based on their strong linear relationships with egg prices as identified in the data section. Indicator variables were used to numerically represent categorical features, making them suitable for multivariate linear regression.

While time series models are considered due to the temporal nature of the data, the limited historical data available led to the decision to prioritize this linear regression model. Additionally, this analysis uses the abundance of product-related information to focus on exploring the effects that brands and vendors have on egg pricing, making this analysis a good use case for multivariate linear regression. R [@citeR] was used to create and validate this model using RMSE.

# Results

The following estimator $\hat{p}$ for price was constructed using prepossessed data :

$$
\hat{p} = 0.60 -0.05 \cdot \text{sale} -0.12 \cdot \text{voila} + 0.06 \cdot \text{brown} + -0.02 \cdot \text{large} + 0.18 \cdot \text{organic}
\tag{2}
$$

```{r}
#| label: fig-table
#| fig-cap: "Model Summary"

library(knitr)
library(broom)
model <- readRDS("../model/model.rds")
tidy_model <- tidy(model)
tidy_model <- tidy_model |>
  mutate(across(where(is.numeric), round, 2))
kable(tidy_model)
```

This estimator has a RMSE score of 0.08. RMSE was calculated by splitting data into randomized training and testing sets with an 80 20 split. Additional model information can be seen in [@fig-table].

## Discussion

The best way to reduce prices is to get rid of the Canadian grocery monopoly. Unfortunately, this is pretty difficult for the average consumer so some actionable ideas are to buy groceries from the brand No Name. Some other ideas are to eat more plant based meals, buy groceries that last longer such as beans and rice in bulk, and meal planning in advance, [@citeHughes].

This analysis is not perfect due to missing data and bias. Outside of these major grocery chains, there are many smaller farmers who sell their food locally, their prices are not reflected in the data. Additionally, to understand the whole picture of food prices its important to take food substitutions into consideration. When prices are very high, people may opt to use food substitutions, this analysis fails to take food substitutions into account.

There is also a correlation between size and price but there are also some discrepancies which may be the result of egg quality. This factor wasn't taken into account in the analysis. We can't say that larger egg sizes cause higher prices.
